# -*- coding: utf-8 -*-
"""Experiment 4 B Multiple Linear regression.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1S-ObOJH_z9wUTOK2xSavPm0OAYZDSyI5

Step 1:Import libraries
"""

import pandas as pd
import numpy as np

"""step 2:Import Dataset"""

data_df=pd.read_excel('CCCP.xlsx')
data_df.head()

"""step 3: Define x and y """

x=data_df.drop(['PE'],axis=1).values
y=data_df['PE'].values

print(x)

print(y)

"""Step 4 :Split the dataset in training and test set"""

from sklearn.model_selection import train_test_split
x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.33, random_state=0)

"""step 5: Train the model on the training set"""

#Fitting Simple Linear Regression to the Training set
from sklearn.linear_model import LinearRegression
regressor = LinearRegression()
regressor.fit(x_train, y_train)

"""step 6 : Predict the test results"""

y_pred = regressor.predict(x_test)
print(y_pred)

regressor.predict([[14.96,41.76,1024.07,73.17]])

"""Step 7 : Evaluate the model"""

from sklearn.metrics import r2_score
r2_score(y_test,y_pred)

"""Step 8 : Plot the results"""

import matplotlib.pyplot as plt
plt.figure(figsize=(15,10))
plt.scatter(y_test,y_pred)
plt.xlabel('Actual')
plt.ylabel('predicted')
plt.title('ACTUAL VS pREDICTED')